# 数据一致性检查报告

生成时间：2025-11-26

## 数据规模

- **商场总数**: 581 条
- **门店总数**: 1229 条
  - DJI: 788 条
  - Insta360: 441 条

## 检查结果总结

| 检查项 | 状态 | 说明 |
|--------|------|------|
| mall_id 唯一性 | ✅ 通过 | 所有 mall_id 唯一 |
| 门店商场关联 | ✅ 通过 | 所有门店的 mall_id 都在商场表中，mall_name 一致 |
| store_count 准确性 | ✅ 通过 | 所有商场的 store_count 准确 |
| 坐标合理性 | ✅ 通过 | 44 个距离异常已全部修正（门店-商场距离 < 2km） |
| 城市一致性 | ✅ 通过 | 所有门店和商场的城市一致 |
| JSON-CSV 一致性 | ✅ 通过 | CSV/JSON 数量一致，抽样比对一致 |
| 商场名称正常性 | ✅ 通过 | 无店铺名特征 |

**通过率**: 7/7 (100%)

## 修复历史

### 1. 修复门店-商场关联与坐标（44条，2025-11-26）

- 纠正跨城/错配：PARK108国泰优活城市广场（原协信星光广场）、龙湖济南西城天街（原奥体天街）、西安万象城（原西咸万象城）、厦门SM新生活广场（原海沧SM）、郑州郑东万象城（原二七万象城）、千灯湖环宇城（原映月湖环宇城）、万达广场(兰州城关店)等。
- 商场坐标全部替换为高德 POI，门店坐标同步精确到商场/店铺位置（均 < 2km）。
- 重新生成 JSON（dji_stores / insta360_stores / malls），前后端数据一致。

### 2. 使用 LLM 修复商场名称（33条）

将错误的店铺名（屈臣氏、美宜佳、盒马等）修正为正确的商场名。

### 3. 修复重复的 mall_id（9+9=18条）

两次修复重复 ID：
- 第一次：为不同城市的重复商场分配新 ID（MALL_00611-MALL_00619）
- 第二次：清理遗留的重复 ID（MALL_00631-MALL_00639）

### 4. 拆分错误合并的商场（17条）

将被错误合并到同一个 mall_id 的不同商场拆分，新建商场：
- 深圳前海壹方汇
- 重庆时代天街、重庆光环花园城
- 深圳华强北赛格科技园
- 厦门SM新生活广场
- 德阳旌阳万达广场
- 广州荔湾领展购物广场
- 保定北国先天下
- 长沙宜家荟聚
- 大庆让胡路万达广场
- 福州烟台山
- 贵阳观山湖万象汇
- 合肥庐阳万象汇
- 深圳大运天地
- 成都IFS国际金融中心
- 等

### 5. 恢复被错误修改的商场名（17条）

LLM 修复脚本将一些商场名错误修改，已恢复为 original_name：
- 永庆坊、深圳宝安机场、荆州万达、昆明恒隆广场等

### 6. 修复城市不匹配（7条）

修正了因拆分商场时关联错误导致的城市不匹配问题。

### 7. 清理无门店商场（7条）

删除了没有门店关联的商场记录。

## 需要注意的问题

### 同一品牌在同一商场有多家门店（11条，暂不处理）

| 商场 | 品牌 | 数量 | 说明 |
|------|------|------|------|
| 昆山万象汇 | Insta360 | 2 | 疑似重复 |
| 重庆来福士广场 | Insta360 | 2 | 疑似重复 |
| 北京朝阳合生汇 | Insta360 | 2 | 疑似重复 |
| 南宁万象城 | DJI | 2 | 概念店+授权店 |
| 厦门万象城 | DJI | 2 | 概念店+授权店 |
| 太古汇 | DJI | 2 | DJI店+哈苏店 |
| 昆明恒隆广场 | DJI | 2 | 概念店+授权店 |
| 正佳广场 | DJI | 2 | 授权专区+授权店 |
| 万达广场(南昌红谷滩店) | DJI | 2 | 授权店+授权专区 |
| 天津万象城 | DJI | 2 | 概念店+授权店 |
| 成都太古里 | DJI | 2 | DJI店+哈苏店 |

## 数据文件状态

- ✅ `Mall_Master_Cleaned.csv`: 581 条商场记录
- ✅ `Store_Master_Cleaned.csv`: 1229 条门店记录
- ✅ JSON 与 CSV 一致：`dji_stores.json` 788 条、`insta360_stores.json` 441 条、`malls.json` 581 条

## 建议

1. 如需进一步去重，可逐个核实上述 11 组重复门店后再处理。
2. 新增或调整数据后，先运行 `comprehensive_data_check.py` 再执行 `python csv_to_json.py` 生成前端数据。
3. 保留 `.env.local` 中的高德 Key，便于后续精定位或新增商场/门店校验。
